#compdef unmount_share

_unmount_share() {
    local -a mount_points
    local cur

    cur="${words[CURRENT]}"

    # Generate the list of server_share options
    mount_points=(${(M)${(f)"$(ls -d ${HOME}/mnt/*/*)"}##${HOME}/mnt/*/(*)_}:t)

    # Apply completion
    if (( ${#mount_points} )); then
        _describe 'server_share' mount_points -- $cur
    else
        _message 'no mounted shares to unmount'
    fi
}

_unmount_share
